"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[395],{95395:function(e,l,t){t.r(l),t.d(l,{default:function(){return ManageFormPage}});var i=t(57437),s=t(2265),a=t(79404),n=t(33071),d=t(40613),r=t(8287),o=t(83905),c=t(73019),m=t(73376),u=t(84792),x=t(25126),v=t(82816),PreviewForm=e=>{let{open:l,onCancel:t,formValues:s}=e,saveForm=async()=>{let e=await d.Z.post("dynamicform/form",{name:"v1",data:s});console.log(e.data),t()};return(0,i.jsx)(n.Z,{title:"Preview Form",open:l,onCancel:t,footer:null,children:(0,i.jsxs)("div",{className:"",children:[(0,i.jsx)(v.Z,{preview:!0,formValues:s}),(0,i.jsx)("button",{onClick:saveForm,className:"flex bg-[#F04D99] text-white rounded-md mt-10 py-2 px-4 mx-auto mb-10",children:"Save Form"})]})})},h=t(43574),p=t(16681),j=t(67848),f=t(88110),g=t.n(f);function EditForm(e){var l;let{open:t,onCancel:d,onOk:r,name:o,initialValues:c,sectionName:m,sectionIndex:u}=e,[x]=a.Z.useForm(),[v,f]=(0,s.useState)(!1),[F,b]=(0,s.useState)([]),[y,N]=(0,s.useState)(""),[C,D]=(0,s.useState)(null!==(l=null==c?void 0:c.type)&&void 0!==l?l:"text");return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(n.Z,{title:"".concat(o," in ").concat(m),open:t,onCancel:d,onOk:()=>{x.validateFields().then(async e=>{console.log(e),e.type=C,e.isEditable=!0,("select"===C||"radio"===C)&&(e.data=F),r(u,e),x.resetFields(),f(!1)}).catch(e=>{console.log("Validate Failed:",e)})},okText:"Save",okButtonProps:{style:{backgroundColor:"#F04D99"}},children:[(0,i.jsx)("span",{className:"text-lg font-semibold",children:"Field Type"}),(0,i.jsxs)(j.ZP.Group,{onChange:e=>D(e.target.value),value:C,children:[(0,i.jsx)(j.ZP,{className:"py-2",value:"text",children:"Text Field"}),(0,i.jsx)(j.ZP,{className:"py-2",value:"radio",children:"Radio Field"}),(0,i.jsx)(j.ZP,{className:"py-2",value:"date",children:"Date Picker"}),(0,i.jsx)(j.ZP,{className:"py-2",value:"select",children:"Select Field"}),(0,i.jsx)(j.ZP,{className:"py-2",value:"image",children:"Uplaod Image Field"})]}),(0,i.jsx)("div",{className:"mt-2",children:(0,i.jsxs)(a.Z,{form:x,layout:"vertical",initialValues:c,children:[(0,i.jsx)(a.Z.Item,{name:"name",label:(0,i.jsx)("span",{className:"text-md font-semibold",children:"Name of the field (label)"}),rules:[{required:!0,message:"Field name is required!"}],children:(0,i.jsx)(h.Z,{className:"rounded-md"})}),(0,i.jsx)(a.Z.Item,{name:"isRequired",label:(0,i.jsx)("span",{className:"text-lg font-semibold",children:"Is it required?"}),valuePropName:"checked",children:(0,i.jsx)(p.Z,{onChange:e=>{f(e.target.checked)},defaultChecked:!1,children:"Required"})}),(0,i.jsx)(a.Z.Item,{name:"errorMessage",label:(0,i.jsx)("span",{className:"text-lg font-semibold",children:"Error Message"}),rules:[{required:v,message:"Error message is required if Required is checked!"}],children:(0,i.jsx)(h.Z,{className:"rounded-md",disabled:!v})}),"select"===C||"radio"===C?(0,i.jsx)("div",{children:(0,i.jsxs)("div",{children:[(0,i.jsx)(h.Z,{className:"rounded-md",placeholder:"Enter new option",value:y,onChange:e=>N(e.target.value)}),(0,i.jsx)("div",{children:(0,i.jsx)(g(),{className:"flex bg-[#F04D99] text-white rounded-md mt-2 px-4 mx-auto",onClick:()=>{(null==y?void 0:y.trim())!==""&&(b([...F,{_id:null==y?void 0:y.trim(),name:null==y?void 0:y.trim()}]),N(null))},children:"Add Option"})}),(0,i.jsx)("ul",{className:"disk",children:null==F?void 0:F.map((e,l)=>(0,i.jsx)("li",{children:null==e?void 0:e._id},l))})]})}):null]})})]})})}function EditSection(e){let{open:l,onCancel:t,onOk:s,name:d,initialValues:r}=e,[o]=a.Z.useForm();return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(n.Z,{title:"".concat(d),open:l,onCancel:t,onOk:()=>{o.validateFields().then(async e=>{console.log(e),s(e),o.resetFields()}).catch(e=>{console.log("Validate Failed:",e)})},okText:"Save",okButtonProps:{style:{backgroundColor:"#F04D99"}},children:(0,i.jsx)("div",{className:"mt-2",children:(0,i.jsx)(a.Z,{form:o,layout:"vertical",initialValues:r,children:(0,i.jsx)(a.Z.Item,{name:"name",label:(0,i.jsx)("span",{children:"Name of the section"}),rules:[{required:!0,message:"Field name is required!"}],children:(0,i.jsx)(h.Z,{className:"rounded-md"})})})})})})}var F=t(45246),svg_delete=function(){return(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"2.5",stroke:"white",className:"w-4 h-4",children:(0,i.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})})},adminForm_AdminForm=e=>{let{onFormSubmit:l}=e,[t,v]=(0,s.useState)([]),[h,p]=(0,s.useState)([]),[j,f]=(0,s.useState)([]),[g,b]=(0,s.useState)(!1),[y,N]=(0,s.useState)(!1),[C,D]=(0,s.useState)(!1),[k,w]=(0,s.useState)(null),fetchData=async()=>{var e;let l=await d.Z.get("/dynamicform/country-state-city"),t=null===(e=l.data)||void 0===e?void 0:e.countries;v(t)},fetchFormFields=async()=>{var e;let l=await d.Z.get("/dynamicform/form/v1"),t=null===(e=l.data)||void 0===e?void 0:e.data;t&&P(t)};(0,s.useEffect)(()=>{fetchData(),fetchFormFields()},[]);let[E]=a.Z.useForm(),[Z,P]=(0,s.useState)([{section:"Contact Info",fields:[{name:"Phone",type:"phone",isRequired:!0,errorMessage:"Please enter a valid phone number",isEditable:!1},{name:"Email",type:"text",isRequired:!0,errorMessage:"Please enter a valid email address",isEditable:!1},{name:"Country",type:"select",isRequired:!0,errorMessage:"Please select a country",isEditable:!1},{name:"State",type:"select",isRequired:!0,errorMessage:"Please select a State",isEditable:!1},{name:"City",type:"select",isRequired:!0,errorMessage:"Please select a City",isEditable:!1},{name:"Location",type:"text",isRequired:!0,errorMessage:"Please enter your loaction",isEditable:!1}]},{section:"Ad info",fields:[{name:"Title",type:"text",isRequired:!0,errorMessage:"Please add the title",isEditable:!1},{name:"Details",type:"text",isRequired:!0,errorMessage:"Please add the title",isEditable:!1},{name:"Disclaimer",type:"text",isRequired:!0,errorMessage:"Please add the title",isEditable:!1},{name:"Listing Category",type:"select",isRequired:!0,errorMessage:"Please add the title",isEditable:!1,data:[{_id:"1",name:"Premium"},{_id:"2",name:"Standard"}]},{name:"Upload images",type:"image",isRequired:!0,errorMessage:"Please add the title",isEditable:!1}]}]),handleEditFieldClick=e=>{e.preventDefault(),b(!0)},handleEditFieldModalCancel=()=>{b(!1),w(null)},handleEditFieldModalOk=(e,l)=>{console.log(e,l);let t=[...Z];t[e].fields.push(l),P(t),w(null),b(!1)},confirmDeleteField=(e,l)=>{n.Z.confirm({title:"Confirm Deletion",content:"Are you sure you want to delete this field?",okText:"Delete",onOk:()=>deleteField(e,l),okButtonProps:{style:{background:"red",borderColor:"red"}}})},deleteField=(e,l)=>{let t=[...Z];t[e].fields.splice(l,1),P(t)},confirmDeleteSection=e=>{n.Z.confirm({title:"Confirm Deletion",content:"Are you sure you want to delete this section?",okText:"Delete",onOk:()=>deleteSection(e),okButtonProps:{style:{background:"red",borderColor:"red"}}})},deleteSection=e=>{let l=[...Z];l.splice(e,1),P(l)},handleCountryChange=e=>{let l=t.find(l=>l._id===e);l?(p(l.states||[]),E.setFieldsValue({State:void 0,City:void 0})):p([])},handleStateChange=e=>{let l=h.find(l=>l._id===e);l?(f(l.cities||[]),E.setFieldsValue({City:void 0})):f([])},onFormFieldEdit=e=>{w(e),b(!0)};return(0,i.jsxs)("div",{className:"pt-[100px] pb-[50px] w-[80%] md:w-[75%] mx-auto",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(EditSection,{open:y,onCancel:()=>{N(!1)},onOk:e=>{console.log(e),P([...Z,{section:e.name,fields:[]}]),N(!1)},name:"Modify Section",initialValues:k}),(0,i.jsxs)("button",{onClick:e=>{e.preventDefault(),N(!0)},className:"flex bg-[#F04D99] items-center text-white rounded-md py-2 px-4 mx-auto",children:["Add new Section",(0,i.jsx)(F.Z,{})]})]}),(0,i.jsx)("div",{children:(0,i.jsxs)(a.Z,{form:E,onFinish:()=>{E.validateFields().then(e=>{l(e)})},layout:"vertical",children:[null==Z?void 0:Z.map((e,l)=>{var s;return(0,i.jsxs)("div",{className:"border-2 p-3 my-2",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)("div",{className:"text-white text-lg font-semibold",children:["Section: ",null==e?void 0:e.section]}),(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsxs)("button",{onClick:handleEditFieldClick,className:"flex bg-[#F04D99] items-center text-white rounded-md py-2 px-4 my-2",children:["Add new field",(0,i.jsx)(F.Z,{})]}),0!=l&&(0,i.jsxs)("button",{disabled:0==l,onClick:e=>{e.preventDefault(),confirmDeleteSection(l)},className:"flex bg-[#F04D99] items-center text-white rounded-md py-2 px-4 m-2",children:["Delete the section",(0,i.jsx)(svg_delete,{})]})]})]}),(0,i.jsx)(EditForm,{open:g,onCancel:handleEditFieldModalCancel,onOk:handleEditFieldModalOk,name:"Modify Field",initialValues:k,sectionName:null==e?void 0:e.section,sectionIndex:l}),null==e?void 0:null===(s=e.fields)||void 0===s?void 0:s.map((e,s)=>{var a,n,d,v,p,f;return(null==e?void 0:e.type)==="text"?(0,i.jsxs)("div",{className:"flex justify-between items-center ",children:[(0,i.jsx)("div",{className:" flex-1 ",children:(0,i.jsx)(o.Z,{name:null==e?void 0:e.name,rules:[{required:null==e?void 0:e.isRequired,message:null!==(a=null==e?void 0:e.errorMessage)&&void 0!==a?a:"Please enter a value"}]})}),(null==e?void 0:e.isEditable)?(0,i.jsx)("div",{className:"",children:(0,i.jsxs)("div",{className:" pt-2 ml-2",children:[(0,i.jsx)("button",{className:"p-2 mr-2 bg-[#F04D99] text-white rounded-md",onClick:l=>{l.preventDefault(),onFormFieldEdit(e)},children:"Edit"}),(0,i.jsx)("button",{className:"p-2 bg-[#F04D99] text-white rounded-md",onClick:e=>{e.preventDefault(),confirmDeleteField(l,s)},children:"Delete"})]})}):null]},s):(null==e?void 0:e.type)==="phone"?(0,i.jsx)("div",{className:" flex-1",children:(0,i.jsx)(x.Z,{name:null==e?void 0:e.name,rules:[{required:null==e?void 0:e.isRequired,message:null!==(n=null==e?void 0:e.errorMessage)&&void 0!==n?n:"Please enter a value"}]},s)}):(null==e?void 0:e.type)==="select"?(0,i.jsxs)("div",{className:" flex justify-between items-center  ",children:[(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(r.Z,{name:null==e?void 0:e.name,data:(null==e?void 0:e.name)==="Country"?t:(null==e?void 0:e.name)==="State"?h:(null==e?void 0:e.name)==="City"?j:null==e?void 0:e.data,onChange:(null==e?void 0:e.name)==="Country"?handleCountryChange:(null==e?void 0:e.name)==="State"?handleStateChange:null,rules:[{required:null==e?void 0:e.isRequired,message:null!==(d=null==e?void 0:e.errorMessage)&&void 0!==d?d:"Please select a value"}]},s)}),(null==e?void 0:e.isEditable)?(0,i.jsx)("div",{className:"",children:(0,i.jsx)("div",{className:" pt-2 ml-2",children:(0,i.jsx)("button",{className:"p-2 bg-[#F04D99] text-white rounded-md",onClick:e=>{e.preventDefault(),confirmDeleteField(l,s)},children:"Delete"})})}):null]},s):(null==e?void 0:e.type)==="date"?(0,i.jsxs)("div",{className:"flex justify-between items-center  ",children:[(0,i.jsx)("div",{className:" flex-1",children:(0,i.jsx)(c.Z,{name:null==e?void 0:e.name,rules:[{required:null==e?void 0:e.isRequired,message:null!==(v=null==e?void 0:e.errorMessage)&&void 0!==v?v:"Please select a value"}]})}),(null==e?void 0:e.isEditable)?(0,i.jsx)("div",{className:"",children:(0,i.jsxs)("div",{className:" pt-2 ml-2",children:[(0,i.jsx)("button",{className:"p-2 mr-2 bg-[#F04D99] text-white rounded-md",onClick:l=>{l.preventDefault(),onFormFieldEdit(e)},children:"Edit"}),(0,i.jsx)("button",{className:"p-2 bg-[#F04D99] text-white rounded-md",onClick:e=>{e.preventDefault(),confirmDeleteField(l,s)},children:"Delete"})]})}):null]},s):(null==e?void 0:e.type)==="radio"?(0,i.jsxs)("div",{className:"flex justify-between items-center ",children:[(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(u.Z,{name:null==e?void 0:e.name,data:null==e?void 0:e.data,rules:[{required:null==e?void 0:e.isRequired,message:null!==(p=null==e?void 0:e.errorMessage)&&void 0!==p?p:"Please select a value"}]})}),(null==e?void 0:e.isEditable)?(0,i.jsx)("div",{className:"",children:(0,i.jsxs)("div",{className:" pt-2 ml-2",children:[(0,i.jsx)("button",{className:"p-2 mr-2 bg-[#F04D99] text-white rounded-md",onClick:l=>{l.preventDefault(),onFormFieldEdit(e)},children:"Edit"}),(0,i.jsx)("button",{className:"p-2 bg-[#F04D99]  text-white rounded-md",onClick:e=>{e.preventDefault(),confirmDeleteField(l,s)},children:"Delete"})]})}):null]},s):(null==e?void 0:e.type)==="image"?(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(m.Z,{name:null==e?void 0:e.name,rules:[{required:null==e?void 0:e.isRequired,message:null!==(f=null==e?void 0:e.errorMessage)&&void 0!==f?f:"Please select a value"}]})}),(null==e?void 0:e.isEditable)?(0,i.jsx)("div",{className:"",children:(0,i.jsxs)("div",{className:" pt-2 ml-2",children:[(0,i.jsx)("button",{className:"p-2 mr-2 bg-[#F04D99] text-white rounded-md",onClick:l=>{l.preventDefault(),onFormFieldEdit(e)},children:"Edit"}),(0,i.jsx)("button",{className:"p-2 bg-[#F04D99]  text-white rounded-md",onClick:e=>{e.preventDefault(),confirmDeleteField(l,s)},children:"Delete"})]})}):null]},s):void 0})]},l)}),(0,i.jsx)(a.Z.Item,{children:(0,i.jsx)("div",{className:"",children:(0,i.jsx)("button",{className:"flex bg-[#F04D99] text-white rounded-md py-2 px-4 mx-auto",onClick:e=>{e.preventDefault(),D(!0)},children:"Preview"})})})]})}),(0,i.jsx)(PreviewForm,{open:C,onCancel:()=>D(!1),formValues:Z})]})},b=t(24033);function ManageFormPage(){let e=(0,b.useRouter)();return(0,s.useEffect)(()=>{localStorage.getItem("token")||e.push("/login")}),(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("div",{className:"pt-[40px] pb-[50px] w-[80%] md:w-[75%] mx-auto ",children:(0,i.jsx)(adminForm_AdminForm,{onFormSubmit:e=>{console.log("Form submitted with values:",e)}})})})}}}]);